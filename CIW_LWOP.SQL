-- BELOW USES CIW FOR EMP STATUS --
	WITH
		LWOP_01 AS
		(SELECT DISTINCT 
				  EMPLOYEE_ID AS EID
				, row_number() 
					OVER(
						PARTITION BY EMPLOYEE_ID ORDER BY EMPLOYEE_ID, JOB_EFFECTIVE_DATE
						) 
					AS LEAVERECORD
				, CASE 
					WHEN EXTRACT(MONTH FROM JOB_EFFECTIVE_DATE)
						BETWEEN 1 AND 7 
						THEN 
						/* Academic Year is prior calendar year if Spring Term */
							CONCAT(CONCAT(CAST((EXTRACT(YEAR FROM JOB_EFFECTIVE_DATE) - 1) AS VARCHAR(10))
							, ' - ')
							, 	   CAST((EXTRACT(YEAR FROM JOB_EFFECTIVE_DATE)) AS VARCHAR(10)))
					WHEN EXTRACT(MONTH FROM JOB_EFFECTIVE_DATE)
						BETWEEN 8 AND 12 
						THEN 
							CONCAT(CONCAT(CAST((EXTRACT(YEAR FROM JOB_EFFECTIVE_DATE))AS VARCHAR(10)) 
							, ' - ')
							,CAST((EXTRACT(YEAR FROM JOB_EFFECTIVE_DATE) + 1)AS VARCHAR(10)) )
					END AS AY
			    , JOB_EFFECTIVE_DATE
			    , JOB_EXPIRATION_DATE
				, JOB_EMPLMNT_STATUS_CODE
			    , JOB_POSITION_NUM
			    , JOB_JB_CODE
			    , JOB_DEPT_ID
			FROM artemis.HRMS_JOB_TBL
			WHERE JOB_EMPLMNT_STATUS_CODE IN ('L') -- LWOP
				AND JOB_JB_CODE IN ('1100', '1101' ,'1102' ,'1103')
			ORDER BY EMPLOYEE_ID, LEAVERECORD
		)
